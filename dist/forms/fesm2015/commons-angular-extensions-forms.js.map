{"version":3,"file":"commons-angular-extensions-forms.js","sources":["../../../src/forms/update-value-and-validity.ts","../../../src/forms/url-validator.ts","../../../src/forms/commons-angular-extensions-forms.ts"],"sourcesContent":["import {AbstractControl, FormArray, FormGroup} from \"@angular/forms\";\n\nexport function updateValueAndValidity(controlOrControls: AbstractControl | AbstractControl[] | {[control: string]: AbstractControl}, opts?: {onlySelf?: boolean; emitEvent?: boolean; ommit?: AbstractControl[]}) {\n\n    let controls: AbstractControl[];\n\n    if (Array.isArray(controlOrControls)) {\n        controls = controlOrControls;\n    } else if (controlOrControls instanceof AbstractControl) {\n        controls = [controlOrControls];\n    } else if (controlOrControls) {\n        controls = [];\n        for (const k of Object.keys(controlOrControls)) {\n            if (controlOrControls[k]) {\n                controls.push(controlOrControls[k]);\n            }\n        }\n    }\n\n    CONTROLS: for (const control of controls) {\n\n        if (!control) {\n            continue;\n        }\n\n        if (opts && opts.ommit) {\n            for (const c of opts.ommit) {\n                if (c === control) {\n                    continue CONTROLS;\n                }\n            }\n        }\n\n        if (!opts || !opts.onlySelf) {\n            if (control instanceof FormGroup) {\n                const group = (control as FormGroup);\n\n                for (const field in group.controls) {\n                    updateValueAndValidity(group.controls[field], opts);\n                }\n\n            } else if (control instanceof FormArray) {\n                const group = (control as FormArray);\n\n                for (const field in group.controls) {\n                    const c = group.controls[field];\n                    updateValueAndValidity(group.controls[field], opts);\n                }\n            }\n        }\n\n        control.updateValueAndValidity(opts);\n    }\n}\n","import {Directive, forwardRef, NgModule} from \"@angular/core\";\nimport {AbstractControl, NG_VALIDATORS, ValidationErrors, Validator} from \"@angular/forms\";\nimport {MessageRef} from \"@co.mmons/js-intl\";\n\nconst urlValidatorRegex = /((([A-Za-z]{3,9}:(?:\\/\\/)?)(?:[\\-;:&=\\+\\$,\\w]+@)?[A-Za-z0-9\\.\\-]+|(?:www\\.|[\\-;:&=\\+\\$,\\w]+@)[A-Za-z0-9\\.\\-]+)((?:\\/[\\+~%\\/\\.\\w\\-_]*)?\\??(?:[\\-\\+=&;%@\\.\\w_]*)#?(?:[\\.\\!\\/\\\\\\w]*))?)/i;\n\nexport const urlValidatorProvider: any = {\n    provide: NG_VALIDATORS,\n    useExisting: forwardRef(() => UrlValidator),\n    multi: true\n};\n\n@Directive({\n    selector: '[url][formControlName],[url][formControl],[url][ngModel]',\n    providers: [urlValidatorProvider]\n})\nexport class UrlValidator implements Validator {\n\n    static validate(control: AbstractControl): ValidationErrors {\n\n        const value = control.value;\n\n        if (urlValidatorRegex.test(value)) {\n            return undefined;\n        }\n\n        return {\n            invalidUrl: new MessageRef(\"@co.mmons/angular-extensions/forms\", \"invalidUrlError\")\n        };\n    }\n\n    validate(c: AbstractControl): ValidationErrors | null {\n        return UrlValidator.validate(c);\n    }\n\n}\n\n@NgModule({\n    declarations: [UrlValidator],\n    exports: [UrlValidator]\n})\nexport class UrlValidatorModule {\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":";;;;SAEgB,sBAAsB,CAAC,iBAA6F,EAAE,IAA2E;IAE7M,IAAI,QAA2B,CAAC;IAEhC,IAAI,KAAK,CAAC,OAAO,CAAC,iBAAiB,CAAC,EAAE;QAClC,QAAQ,GAAG,iBAAiB,CAAC;KAChC;SAAM,IAAI,iBAAiB,YAAY,eAAe,EAAE;QACrD,QAAQ,GAAG,CAAC,iBAAiB,CAAC,CAAC;KAClC;SAAM,IAAI,iBAAiB,EAAE;QAC1B,QAAQ,GAAG,EAAE,CAAC;QACd,KAAK,MAAM,CAAC,IAAI,MAAM,CAAC,IAAI,CAAC,iBAAiB,CAAC,EAAE;YAC5C,IAAI,iBAAiB,CAAC,CAAC,CAAC,EAAE;gBACtB,QAAQ,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC,CAAC;aACvC;SACJ;KACJ;IAED,QAAQ,EAAE,KAAK,MAAM,OAAO,IAAI,QAAQ,EAAE;QAEtC,IAAI,CAAC,OAAO,EAAE;YACV,SAAS;SACZ;QAED,IAAI,IAAI,IAAI,IAAI,CAAC,KAAK,EAAE;YACpB,KAAK,MAAM,CAAC,IAAI,IAAI,CAAC,KAAK,EAAE;gBACxB,IAAI,CAAC,KAAK,OAAO,EAAE;oBACf,SAAS,QAAQ,CAAC;iBACrB;aACJ;SACJ;QAED,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;YACzB,IAAI,OAAO,YAAY,SAAS,EAAE;gBAC9B,MAAM,KAAK,GAAI,OAAqB,CAAC;gBAErC,KAAK,MAAM,KAAK,IAAI,KAAK,CAAC,QAAQ,EAAE;oBAChC,sBAAsB,CAAC,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,IAAI,CAAC,CAAC;iBACvD;aAEJ;iBAAM,IAAI,OAAO,YAAY,SAAS,EAAE;gBACrC,MAAM,KAAK,GAAI,OAAqB,CAAC;gBAErC,KAAK,MAAM,KAAK,IAAI,KAAK,CAAC,QAAQ,EAAE;oBAChC,MAAM,CAAC,GAAG,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;oBAChC,sBAAsB,CAAC,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,IAAI,CAAC,CAAC;iBACvD;aACJ;SACJ;QAED,OAAO,CAAC,sBAAsB,CAAC,IAAI,CAAC,CAAC;KACxC;AACL;;ACjDA,MAAM,iBAAiB,GAAG,uLAAuL,CAAC;MAErM,oBAAoB,GAAQ;IACrC,OAAO,EAAE,aAAa;IACtB,WAAW,EAAE,UAAU,CAAC,MAAM,YAAY,CAAC;IAC3C,KAAK,EAAE,IAAI;EACb;MAMW,YAAY;IAErB,OAAO,QAAQ,CAAC,OAAwB;QAEpC,MAAM,KAAK,GAAG,OAAO,CAAC,KAAK,CAAC;QAE5B,IAAI,iBAAiB,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE;YAC/B,OAAO,SAAS,CAAC;SACpB;QAED,OAAO;YACH,UAAU,EAAE,IAAI,UAAU,CAAC,oCAAoC,EAAE,iBAAiB,CAAC;SACtF,CAAC;KACL;IAED,QAAQ,CAAC,CAAkB;QACvB,OAAO,YAAY,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;KACnC;;;YArBJ,SAAS,SAAC;gBACP,QAAQ,EAAE,0DAA0D;gBACpE,SAAS,EAAE,CAAC,oBAAoB,CAAC;aACpC;;MA0BY,kBAAkB;;;YAJ9B,QAAQ,SAAC;gBACN,YAAY,EAAE,CAAC,YAAY,CAAC;gBAC5B,OAAO,EAAE,CAAC,YAAY,CAAC;aAC1B;;;ACxCD;;;;;;"}